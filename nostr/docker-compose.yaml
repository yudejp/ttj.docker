services:
  nostr:
    container_name: nostr-relay
    image: ghcr.io/yude/nostr-rs-relay:master
    restart: always
    volumes:
      - type: bind
        source: "./data"
        target: "/usr/src/app/db"
      - type: bind
        source: "./config.toml"
        target: "/usr/src/app/config.toml"
  
  cloudflared:
    image: cloudflare/cloudflared:latest
    user: root
    restart: unless-stopped
    command: tunnel --url http://nostr:8080 --no-chunked-encoding run nostr.yude.jp
    volumes:
      - '/root/.cloudflared:/root/.cloudflared'